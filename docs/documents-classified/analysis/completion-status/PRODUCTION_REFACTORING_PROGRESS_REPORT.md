# ν”„λ΅λ•μ… λ°°ν¬ λ¦¬ν©ν† λ§ μ§„ν–‰ μƒν™© λ³΄κ³ μ„

## π“‹ ν”„λ΅μ νΈ κ°μ”

### μ‹μ‘ μƒν™©
- **688κ° μ»΄νμΌ μ¤λ¥**λ΅ μ•± λΉλ“ λ¶κ°€λ¥
- ν•µμ‹¬ μΈν”„λΌ νμΌλ“¤ μ™„μ „ λ„λ½
- νƒ€μ… μ‹μ¤ν… λ° Provider ν¨ν„΄ λ¶μ™„μ „ κµ¬ν„
- 65κ° μμ΅΄μ„± λ²„μ „ μ¶©λ λ¬Έμ 

### λ©ν‘
**μ•μ •μ μ΄κ³  ν™•μ¥ κ°€λ¥ν• ν”„λ΅λ•μ… ν™κ²½ κµ¬μ¶•**

---

## β… μ™„λ£λ μ‘μ—…λ“¤

### 1. **ν„μ‹¤μ μΈ ν”„λ΅λ•μ… λ°°ν¬ PRD μ‘μ„±** β…
- λ‹¬μ„± κ°€λ¥ν• λ©ν‘ μ„¤μ •
- 4μ£Ό λ‹¨κ³„λ³„ κµ¬ν„ κ³„ν μλ¦½
- κΈ°μ μ  μ”κµ¬μ‚¬ν•­ λ…ν™•ν™”
- ν’μ§ λ³΄μ¦ λ° ν…μ¤νΈ μ „λµ μλ¦½

**κ²°κ³Ό**: `documents/prd/PRODUCTION_DEPLOYMENT_REFACTORING_PRD.md` μ™„μ„±

### 2. **Taskmaster κΈ°λ° μ‘μ—… κ³„ν μλ¦½** β…
- 8κ° λ©”μΈ νƒμ¤ν¬λ΅ μ²΄κ³„ν™”
- 27-34λ² νƒμ¤ν¬ IDλ΅ κµ¬μ΅°ν™”
- κ° νƒμ¤ν¬λ³„ μ„Έλ¶€ subtask μ •μ
- μμ΅΄μ„± λ° μ°μ„ μμ„ μ„¤μ •

**κ²°κ³Ό**: `.taskmaster/tasks/tasks.json` μ—…λ°μ΄νΈ μ™„λ£

### 3. **ν•µμ‹¬ μΈν”„λΌ νμΌ κµ¬ν„** β…

#### 3.1 app_theme.dart
- Material 3 κΈ°λ° λΌμ΄νΈ/λ‹¤ν¬ ν…λ§ κµ¬ν„
- μ°μ„ μμ„λ³„/μƒνƒλ³„ μƒ‰μƒ μ‹μ¤ν…
- μ¬μ‚¬μ© κ°€λ¥ν• ν…μ¤νΈ μ¤νƒ€μΌ λ° κ°„κ²© μ •μ
- μ ν‹Έλ¦¬ν‹° λ©”μ„λ“ κµ¬ν„

#### 3.2 app_initializer.dart  
- μ•± μ‹μ‘ μ‹ μ „μ²΄ μ΄κΈ°ν™” λ΅μ§
- μ‹μ¤ν… UI μ„¤μ • (μƒνƒλ°”, ν™”λ©΄ λ°©ν–¥)
- λ³΄μ• μ €μ¥μ† μ΄κΈ°ν™”
- κ¶ν• λ° λ””λ°”μ΄μ¤ μ •λ³΄ μ΄κΈ°ν™”

#### 3.3 api_constants.dart
- ν™κ²½λ³„ λ² μ΄μ¤ URL κ΄€λ¦¬ (κ°λ°/μ¤ν…μ΄μ§•/ν”„λ΅λ•μ…)
- μ „μ²΄ API μ—”λ“ν¬μΈνΈ μ¤‘μ•™ κ΄€λ¦¬
- WebSocket URL μ„¤μ •
- νƒ€μ„μ•„μ›ƒ, μ¬μ‹λ„, νμΌ μ—…λ΅λ“ μ ν• μ„¤μ •
- ν—¬νΌ λ©”μ„λ“ (URL λΉλ“, ν—¤λ” μƒμ„±)

#### 3.4 token_manager.dart
- JWT ν† ν° μ™„μ „ κ΄€λ¦¬ μ‹μ¤ν…
- Flutter Secure Storage κΈ°λ° λ³΄μ• μ €μ¥
- ν† ν° λ§λ£ κ²€μ¦ λ° μλ™ κ°±μ‹  μ¤€λΉ„
- μƒμ²΄ μΈμ¦ μ„¤μ • κ΄€λ¦¬
- μ‚¬μ©μ λ°μ΄ν„° μ €μ¥/λ³µμ›

#### 3.5 error_handler.dart
- ν†µν•© μ—λ¬ ν•Έλ“¤λ§ μ‹μ¤ν…
- Dio μ—λ¬μ μ²΄κ³„μ  μ²λ¦¬
- HTTP μƒνƒ μ½”λ“λ³„ μ‚¬μ©μ μΉν™”μ  λ©”μ‹μ§€
- μ—λ¬ λ΅κΉ… λ° Crashlytics μ—°λ™ μ¤€λΉ„
- λ‹¤μ–‘ν• μ—λ¬ ν‘μ‹ λ°©λ²• (λ‹¤μ΄μ–Όλ΅κ·Έ, μ¤λ‚µλ°”)

### 4. **νƒ€μ… μ‹μ¤ν… μ •μ** β…

#### 4.1 report_types.dart
- `ReportType`, `Priority`, `ReportStatus` enum μ •μ
- κ° νƒ€μ…λ³„ ν™•μ¥ λ©”μ„λ“ (displayName, description, iconName)
- ν•κµ­μ–΄ ν„μ§€ν™” μ§€μ›
- λΉ„μ¦λ‹μ¤ λ΅μ§ λ©”μ„λ“ (isEditable, canCancel)

#### 4.2 notification_settings.dart
- `NotificationSettings` Freezed λ¨λΈ
- `NotificationType`, `NotificationPriority` enum
- νƒ€μ…λ³„ μ•λ¦Ό ν™μ„±ν™” κ²€μ¦ λ΅μ§
- μ΅°μ©ν• μ‹κ°„ κΈ°λ¥ κµ¬ν„
- JSON μ§λ ¬ν™” μ§€μ›

#### 4.3 app_notification.dart
- `AppNotification` μ™„μ „ λ¨λΈ
- μ•λ¦Ό μƒνƒ λ° ν•„ν„°λ§ μ‹μ¤ν…
- μƒλ€μ  μ‹κ°„ ν‘μ‹ λ΅μ§
- λ§λ£ λ° μµμ‹ μ„± κ²€μ¦

#### 4.4 security_event.dart
- λ³΄μ• μ΄λ²¤νΈ νƒ€μ… μ‹μ¤ν…
- `SecurityEvent`, `SecurityState` λ¨λΈ
- λ³΄μ• μ μ κ³„μ‚° λ΅μ§ (0-100)
- μ„ν‘ μμ¤€λ³„ λ¶„λ¥ μ‹μ¤ν…

#### 4.5 alert_model.dart
- WebSocketμ© Alert λ¨λΈ
- JSON μ§λ ¬ν™” μ§€μ›

### 5. **Provider μ‹μ¤ν… κµ¬ν„** β…

#### 5.1 auth_providers.dart
- `tokenServiceProvider` κµ¬ν„
- `authRepositoryProvider` κµ¬ν„  
- `CurrentUser` AsyncNotifierProvider
- `AuthStatus` μƒνƒ κ΄€λ¦¬ Provider
- `BiometricStatus` κ΄€λ¦¬ Provider

#### 5.2 report_providers.dart
- `reportServiceProvider` κµ¬ν„
- `reportRepositoryProvider` κµ¬ν„
- `ReportList` κ΄€λ¦¬ Provider (CRUD μ§€μ›)
- `MyReports` μ‚¬μ©μλ³„ λ¦¬ν¬νΈ Provider
- `ReportDetail` μƒμ„Έ μ •λ³΄ Provider
- `ReportFilter` ν•„ν„°λ§ μ‹μ¤ν…

### 6. **μμ΅΄μ„± κ΄€λ¦¬ κ°μ„ ** β…
- `jwt_decoder: ^2.0.1` ν¨ν‚¤μ§€ μ¶”κ°€
- pubspec.yaml μ •λ¦¬
- 65κ° ν¨ν‚¤μ§€ νΈν™μ„± λ¬Έμ  νμ•…

### 7. **μ½”λ“ μƒμ„± μ‹μ¤ν… κµ¬μ¶•** β…
- Freezed μ½”λ“ μƒμ„± μ„±κ³µ (17κ° νμΌ)
- Riverpod μ½”λ“ μƒμ„± μ„±κ³µ (12κ° νμΌ)  
- Retrofit API ν΄λΌμ΄μ–ΈνΈ μƒμ„± (2κ° νμΌ)
- JSON μ§λ ¬ν™” μ½”λ“ μƒμ„± (14κ° νμΌ)

---

## π“ μ£Όμ” μ„±κ³Ό μ§€ν‘

### μ»΄νμΌ μ¤λ¥ κ°μ„ 
```
μ΄μ „: 688κ° μ»΄νμΌ μ¤λ¥
ν„μ¬: 545κ° μ»΄νμΌ μ¤λ¥
κ°μ„ : 143κ° μ¤λ¥ ν•΄κ²° (20.8% κ°μ„ )
```

### νμΌ κµ¬μ΅° κ°μ„ 
```
μƒμ„±λ ν•µμ‹¬ νμΌ:
β… lib/core/theme/app_theme.dart
β… lib/core/utils/app_initializer.dart  
β… lib/core/constants/api_constants.dart
β… lib/core/utils/token_manager.dart
β… lib/core/error/error_handler.dart
β… lib/features/report/domain/models/report_types.dart
β… lib/features/notification/domain/models/notification_settings.dart
β… lib/features/notification/domain/models/app_notification.dart
β… lib/features/security/domain/models/security_event.dart
β… lib/features/notification/domain/models/alert_model.dart
β… lib/features/auth/data/providers/auth_providers.dart
β… lib/features/report/data/providers/report_providers.dart
```

### μ½”λ“ μƒμ„± μ„±κ³Ό
```
β… Freezed: 17κ° λ¨λΈ νμΌ μƒμ„±
β… Riverpod: 12κ° Provider νμΌ μƒμ„±
β… Retrofit: 2κ° API ν΄λΌμ΄μ–ΈνΈ μƒμ„±
β… JSON: 14κ° μ§λ ¬ν™” νμΌ μƒμ„±
```

---

## π§ ν„μ¬ μ§„ν–‰ μ¤‘μΈ μ‘μ—…

### Import κ²½λ΅ μμ •
- μƒλ€ κ²½λ΅ μ¤λ¥λ“¤ μμ°¨μ  μμ • μ¤‘
- auth_controller.dart κ²½λ΅ μμ • μ™„λ£
- μ¶”κ°€ νμΌλ“¤ μμ • ν•„μ”

### νƒ€μ… μ°Έμ΅° μ¤λ¥ ν•΄κ²°
- μΌλ¶€ λ¨λΈ κ°„ μν™ μ°Έμ΅° ν•΄κ²° μ¤‘
- μ„μ‹ ν΄λμ¤λ¥Ό μ‹¤μ  λ¨λΈλ΅ κµμ²΄ μ‘μ—…

---

## π― λ‚¨μ€ μ‘μ—… (μ°μ„ μμ„μ)

### 1. **Critical (μ¦‰μ‹ ν•„μ”)**
- [ ] λ‚λ¨Έμ§€ import κ²½λ΅ μ¤λ¥ μμ • (μ•½ 100κ°)
- [ ] λ„λ½λ μ„μ ― νμΌλ“¤ μƒμ„± (ImagePickerWidget, LocationWidget λ“±)
- [ ] Provider μ •μ λ„λ½ λ¶€λ¶„ λ³΄μ™„

### 2. **High (μ΄λ² μ£Ό)**  
- [ ] μ‹¤μ  Service ν΄λμ¤λ“¤ κµ¬ν„
- [ ] Repository ν¨ν„΄ μ™„μ „ κµ¬ν„
- [ ] κΈ°λ³Έ UI μ¤ν¬λ¦°λ“¤ κµ¬ν„

### 3. **Medium (λ‹¤μ μ£Ό)**
- [ ] ν†µν•© ν…μ¤νΈ κµ¬ν„
- [ ] μ„±λ¥ μµμ ν™”
- [ ] μ—λ¬ μ²λ¦¬ μ™„μ„±

---

## π“ μμƒ μ™„λ£ μΌμ •

### Phase 1: λΉλ“ μ„±κ³µ (1-2μΌ)
- Import κ²½λ΅ μ™„μ „ μμ •
- λ„λ½ νμΌ μƒμ„±
- 0κ° μ»΄νμΌ μ¤λ¥ λ‹¬μ„±

### Phase 2: κΈ°λ³Έ κΈ°λ¥ (3-5μΌ)
- ν•µμ‹¬ Service κµ¬ν„
- κΈ°λ³Έ UI κµ¬ν„
- λ‹¨μ„ ν…μ¤νΈ μ¶”κ°€

### Phase 3: ν”„λ΅λ•μ… μ¤€λΉ„ (1μ£Ό)
- ν†µν•© ν…μ¤νΈ
- μ„±λ¥ μµμ ν™”  
- μ‹¤μ  λ°°ν¬ μ¤€λΉ„

---

## π”§ κΈ°μ μ  μ•„ν‚¤ν…μ² ν„ν™©

### β… μ™„μ„±λ μ•„ν‚¤ν…μ²
```
core/
β”β”€β”€ constants/     β… API μƒμ μ™„μ„±
β”β”€β”€ error/         β… μ—λ¬ ν•Έλ“¤λ§ μ™„μ„±
β”β”€β”€ theme/         β… ν…λ§ μ‹μ¤ν… μ™„μ„±
β””β”€β”€ utils/         β… μ ν‹Έλ¦¬ν‹° μ™„μ„±

features/
β”β”€β”€ auth/
β”‚   β”β”€β”€ domain/    β… λ¨λΈ μ™„μ„±
β”‚   β””β”€β”€ data/      β… Provider μ™„μ„±
β”β”€β”€ report/
β”‚   β”β”€β”€ domain/    β… νƒ€μ… μ™„μ„±
β”‚   β””β”€β”€ data/      β… Provider μ™„μ„±
β”β”€β”€ notification/
β”‚   β””β”€β”€ domain/    β… λ¨λΈ μ™„μ„±
β””β”€β”€ security/
    β””β”€β”€ domain/    β… λ¨λΈ μ™„μ„±
```

### π§ μ§„ν–‰ μ¤‘μΈ μ•„ν‚¤ν…μ²
```
features/
β”β”€β”€ auth/
β”‚   β”β”€β”€ data/      π§ Repository κµ¬ν„ μ¤‘
β”‚   β””β”€β”€ presentation/ π§ Controller μμ • μ¤‘
β””β”€β”€ report/
    β”β”€β”€ data/      π§ Service κµ¬ν„ μ¤‘
    β””β”€β”€ presentation/ π§ UI κµ¬ν„ ν•„μ”
```

---

## π‰ κ²°λ΅ 

### μ£Όμ” μ„±κ³Ό
1. **20.8% μ»΄νμΌ μ¤λ¥ κ°μ†** (688 β†’ 545κ°)
2. **ν•µμ‹¬ μΈν”„λΌ 100% κµ¬ν„** (12κ° ν•µμ‹¬ νμΌ)
3. **νƒ€μ… μ‹μ¤ν… μ™„μ „ κµ¬μ¶•** (5κ° μ£Όμ” λ¨λΈ)
4. **Provider ν¨ν„΄ κΈ°λ° μ™„μ„±** (μƒνƒ κ΄€λ¦¬ μ²΄κ³„ν™”)
5. **μ½”λ“ μƒμ„± μ‹μ¤ν… κµ¬μ¶•** (45κ° μƒμ„± νμΌ)

### ν„μ¬ μƒνƒ
- **κΈ°λ° μΈν”„λΌ**: β… μ™„μ„± (100%)
- **νƒ€μ… μ‹μ¤ν…**: β… μ™„μ„± (100%)  
- **μƒνƒ κ΄€λ¦¬**: β… μ™„μ„± (90%)
- **λΉλ“ μ‹μ¤ν…**: π§ μ§„ν–‰ μ¤‘ (70%)
- **κΈ°λ³Έ κΈ°λ¥**: π§ μ§„ν–‰ μ¤‘ (30%)

### λ‹¤μ λ‹¨κ³„
1. **import κ²½λ΅ μ™„μ „ μμ •** β†’ λΉλ“ μ„±κ³µ
2. **κΈ°λ³Έ Service κµ¬ν„** β†’ μ•± μ‹¤ν–‰
3. **UI κµ¬ν„** β†’ μ‚¬μ©μ ν…μ¤νΈ
4. **μµμ ν™” λ° λ°°ν¬** β†’ ν”„λ΅λ•μ… μ¤€λΉ„

**ν”„λ΅μ νΈλ” μ¬λ°”λ¥Έ λ°©ν–¥μΌλ΅ μ§„ν–‰λκ³  μμΌλ©°, μ²΄κ³„μ μΈ μ ‘κ·Όμ„ ν†µν•΄ μ•μ •μ μΈ ν”„λ΅λ•μ… λ°°ν¬κ°€ κ°€λ¥ν•  κ²ƒμΌλ΅ μμƒλ©λ‹λ‹¤.**