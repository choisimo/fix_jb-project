# 전라북도 신고 플랫폼 - 사용자 플로우 및 시각적 가이드

## 📱 전체 앱 플로우 다이어그램

```mermaid
graph TD
    A[앱 시작] --> B{로그인 상태}
    B -->|미로그인| C[로그인/회원가입]
    B -->|로그인됨| D[홈 화면]
    
    C --> C1[로그인 화면]
    C --> C2[회원가입 화면]
    C2 --> C3[인증 화면]
    C3 --> D
    C1 --> D
    
    D --> E[신고 목록]
    D --> F[새 신고 작성]
    D --> G[설정]
    
    F --> F1[카테고리 선택]
    F1 --> F2[사진 촬영/선택]
    F2 --> F3[위치 설정]
    F3 --> F4[AI 분석]
    F4 --> F5[상세 정보 입력]
    F5 --> F6[신고 제출]
    F6 --> H[신고 완료]
    
    E --> E1[신고 상세]
    E1 --> E2[진행 상황 확인]
    E1 --> E3[댓글 확인]
    
    G --> G1[알림 설정]
    G --> G2[개인정보 관리]
    G --> G3[보안 설정]
```

---

## 🔐 인증 플로우

### 1. 회원가입 플로우
```mermaid
sequenceDiagram
    participant U as 사용자
    participant A as 앱
    participant S as 서버
    participant V as 인증 서비스
    
    U->>A: 회원가입 시작
    A->>U: 개인정보 입력 폼
    U->>A: 정보 입력 (이메일, 비밀번호, 이름, 폰번호)
    A->>A: 실시간 유효성 검사
    A->>S: 가입 요청
    S->>S: 중복 확인
    S->>V: 인증번호 발송 요청
    V->>U: SMS/이메일 발송
    U->>A: 인증번호 입력
    A->>S: 인증 확인
    S->>A: 회원가입 완료
    A->>U: 홈 화면 이동
```

### 2. 로그인 플로우
```mermaid
flowchart TD
    A[로그인 화면] --> B{인증 방식 선택}
    
    B -->|이메일/비밀번호| C[로그인 폼]
    B -->|소셜 로그인| D[소셜 로그인 선택]
    B -->|생체 인증| E[생체 인증]
    
    C --> C1[입력 검증]
    C1 -->|성공| F[홈 화면]
    C1 -->|실패| C2[오류 메시지]
    C2 --> C
    
    D --> D1[Google 로그인]
    D --> D2[Kakao 로그인]
    D --> D3[Naver 로그인]
    D --> D4[Apple 로그인]
    D1 --> F
    D2 --> F
    D3 --> F
    D4 --> F
    
    E --> E1[지문/얼굴 인식]
    E1 -->|성공| F
    E1 -->|실패| E2[재시도/폴백]
    E2 --> C
```

---

## 📝 신고 작성 플로우

### 1. 신고 작성 상세 플로우
```mermaid
graph TD
    A[새 신고 버튼] --> B[카테고리 선택]
    
    B --> B1[도로관리]
    B --> B2[환경관리]
    B --> B3[시설관리]
    B --> B4[안전관리]
    B --> B5[교통관리]
    
    B1 --> C[사진/동영상 추가]
    B2 --> C
    B3 --> C
    B4 --> C
    B5 --> C
    
    C --> C1[카메라 촬영]
    C --> C2[갤러리 선택]
    C --> C3[동영상 촬영]
    
    C1 --> D[위치 정보 설정]
    C2 --> D
    C3 --> D
    
    D --> D1[현재 위치 자동 감지]
    D --> D2[지도에서 위치 선택]
    D --> D3[주소 직접 입력]
    
    D1 --> E[AI 분석 시작]
    D2 --> E
    D3 --> E
    
    E --> E1[이미지 업로드]
    E1 --> E2[Roboflow AI 분석]
    E2 --> E3[OpenRouter 텍스트 분석]
    E3 --> E4[분석 결과 표시]
    
    E4 --> F[상세 정보 입력]
    F --> F1[제목 입력]
    F1 --> F2[상세 설명 입력]
    F2 --> F3[긴급도 설정]
    F3 --> G[최종 검토]
    
    G --> H[신고 제출]
    H --> I[제출 완료 알림]
    I --> J[홈 화면 복귀]
```

### 2. AI 분석 프로세스
```mermaid
sequenceDiagram
    participant U as 사용자
    participant App as Flutter 앱
    participant Main as Main API
    participant AI as AI Analysis
    participant R as Roboflow
    participant O as OpenRouter
    
    U->>App: 사진 업로드
    App->>Main: 신고 생성 요청
    Main->>AI: AI 분석 요청
    
    par 이미지 분석
        AI->>R: 객체 감지 요청
        R->>AI: 감지 결과 반환
    and 텍스트 분석
        AI->>O: 텍스트 분석 요청
        O->>AI: 분석 결과 반환
    end
    
    AI->>AI: 결과 통합 및 처리
    AI->>Main: 분석 완료
    Main->>App: 분석 결과 전송
    App->>U: AI 추천 정보 표시
```

---

## 🏠 홈 화면 구조

### 홈 화면 레이아웃
```
┌─────────────────────────────┐
│ 🔔 알림     전북신고     ⚙️ 설정 │
├─────────────────────────────┤
│                             │
│    🚨 긴급 신고하기 버튼       │
│                             │
├─────────────────────────────┤
│ 📊 나의 신고 현황              │
│ ┌───┬───┬───┬───────────┐     │
│ │대기│처리│완료│   신고통계   │     │
│ │ 3 │ 5 │12 │           │     │
│ └───┴───┴───┴───────────┘     │
├─────────────────────────────┤
│ 📋 최근 신고 목록              │
│ ┌─────────────────────────┐   │
│ │ 🚧 도로 파손              │   │
│ │ 📍 전주시 덕진구          │   │
│ │ ⏰ 2시간 전 • 🟡 처리중    │   │
│ └─────────────────────────┘   │
│ ┌─────────────────────────┐   │
│ │ 🗑️ 불법 투기              │   │
│ │ 📍 익산시 중앙동          │   │
│ │ ⏰ 1일 전 • 🟢 완료       │   │
│ └─────────────────────────┘   │
├─────────────────────────────┤
│ 🔄 새로고침  📅 필터  🔍 검색   │
└─────────────────────────────┘
```

### 홈 화면 상호작용 플로우
```mermaid
graph TD
    A[홈 화면] --> B[긴급 신고 버튼]
    A --> C[신고 현황 카드]
    A --> D[최근 신고 목록]
    A --> E[하단 네비게이션]
    
    B --> B1[즉시 신고 작성]
    
    C --> C1[대기중 신고]
    C --> C2[처리중 신고]
    C --> C3[완료 신고]
    C --> C4[통계 상세]
    
    D --> D1[신고 카드 탭]
    D1 --> D2[신고 상세 화면]
    
    E --> E1[홈]
    E --> E2[신고 목록]
    E --> E3[새 신고]
    E --> E4[알림]
    E --> E5[마이페이지]
```

---

## 📋 신고 관리 플로우

### 신고 상태 변화 플로우
```mermaid
stateDiagram-v2
    [*] --> 작성중
    작성중 --> 제출완료 : 신고 제출
    제출완료 --> 접수됨 : 관리자 확인
    접수됨 --> 검토중 : 담당자 배정
    검토중 --> 처리중 : 처리 시작
    검토중 --> 추가정보요청 : 정보 부족
    추가정보요청 --> 검토중 : 정보 보완
    처리중 --> 처리완료 : 작업 완료
    처리중 --> 보류 : 임시 중단
    보류 --> 처리중 : 재개
    처리완료 --> 확인완료 : 사용자 확인
    검토중 --> 반려 : 부적절한 신고
    
    처리완료 --> [*]
    확인완료 --> [*]
    반려 --> [*]
```

### 신고 추적 화면 구조
```
┌─────────────────────────────┐
│ ← 신고 상세 (ID: #12345)      │
├─────────────────────────────┤
│ 📸 [신고 이미지]              │
│                             │
├─────────────────────────────┤
│ 📍 위치: 전주시 덕진구 덕진동   │
│ 📅 신고일: 2025-01-15 14:30  │
│ 🏷️ 카테고리: 도로관리         │
│ ⚡ 우선순위: 긴급            │
├─────────────────────────────┤
│ 📊 처리 진행 상황              │
│ ┌─○─○─○─○─○─┐               │
│ │접수│검토│처리│완료│확인│         │
│ │ ✓ │ ✓ │ ● │   │   │         │
│ └───────────────┘               │
│ 현재: 처리중 (30% 완료)         │
│ 예상 완료: 2025-01-20          │
├─────────────────────────────┤
│ 💬 처리 댓글                  │
│ ┌─────────────────────────┐   │
│ │ 👤 김관리자 (도로관리팀)   │   │
│ │ 현장 확인 완료했습니다.    │   │
│ │ 📅 2025-01-16 09:15     │   │
│ └─────────────────────────┘   │
├─────────────────────────────┤
│ [📝 댓글 추가] [📞 문의하기]    │
└─────────────────────────────┘
```

---

## 🔔 알림 시스템 플로우

### 알림 생성 및 전송 플로우
```mermaid
sequenceDiagram
    participant S as 시스템
    participant DB as 데이터베이스
    participant N as 알림 서비스
    participant F as Firebase
    participant U as 사용자 앱
    
    S->>DB: 신고 상태 변경
    DB->>N: 상태 변경 이벤트
    N->>N: 알림 규칙 확인
    N->>DB: 알림 생성
    
    par 푸시 알림
        N->>F: FCM 전송 요청
        F->>U: 푸시 알림 표시
    and 인앱 알림
        N->>U: 실시간 알림 전송
        U->>U: 알림 센터 업데이트
    end
    
    U->>U: 알림 탭
    U->>S: 관련 페이지 이동
```

### 알림 타입별 처리
```mermaid
graph TD
    A[알림 수신] --> B{알림 타입}
    
    B -->|신고 접수| C1[접수 완료 메시지]
    B -->|상태 변경| C2[진행 상황 업데이트]
    B -->|댓글 알림| C3[새 댓글 알림]
    B -->|완료 알림| C4[처리 완료 알림]
    B -->|시스템 공지| C5[공지사항 알림]
    
    C1 --> D[신고 상세 화면]
    C2 --> D
    C3 --> E[댓글 화면]
    C4 --> F[완료 확인 화면]
    C5 --> G[공지사항 화면]
```

---

## 🔒 보안 및 인증 플로우

### 생체 인증 설정 플로우
```mermaid
flowchart TD
    A[설정 화면] --> B[보안 설정]
    B --> C[생체 인증 활성화]
    
    C --> D{기기 지원 확인}
    D -->|지원| E[생체 정보 등록]
    D -->|미지원| F[비밀번호 인증만 가능]
    
    E --> G{등록 성공}
    G -->|성공| H[생체 인증 활성화]
    G -->|실패| I[재시도 또는 건너뛰기]
    
    H --> J[로그인 시 생체 인증 사용]
```

### 앱 보안 검사 플로우
```mermaid
sequenceDiagram
    participant A as 앱 시작
    participant S as 보안 모듈
    participant D as 디바이스
    participant B as 백엔드
    
    A->>S: 보안 검사 시작
    S->>D: 루팅/탈옥 검사
    D->>S: 검사 결과
    S->>D: 앱 무결성 확인
    D->>S: 무결성 결과
    S->>D: 디버그 모드 확인
    D->>S: 디버그 상태
    
    alt 보안 위험 감지
        S->>A: 앱 종료 또는 제한 모드
    else 보안 검사 통과
        S->>B: 보안 상태 전송
        B->>A: 정상 실행 허용
    end
```

---

## 👑 관리자 기능 플로우

### 관리자 대시보드 구조
```
┌─────────────────────────────────────────┐
│ 🏛️ 전북 신고 관리 시스템                  │
├─────────────────────────────────────────┤
│ 📊 실시간 현황                            │
│ ┌────────┬────────┬────────┬──────────┐  │
│ │ 총 신고 │ 대기중  │ 처리중  │ 완료율    │  │
│ │  1,234 │   56   │   89   │  94.2%  │  │
│ └────────┴────────┴────────┴──────────┘  │
├─────────────────────────────────────────┤
│ 📈 트렌드 차트                            │
│ [신고 증감 추이 그래프]                    │
├─────────────────────────────────────────┤
│ 🚨 긴급 신고 목록                         │
│ ┌───────────────────────────────────────┐ │
│ │ 🚧 도로 붕괴 위험 (전주시)              │ │
│ │ ⏰ 30분 전 • 👤 미배정                │ │
│ │ [📋 배정] [👁️ 상세]                    │ │
│ └───────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│ 👥 팀 성과                               │
│ ┌─────────┬─────────┬─────────┬───────┐   │
│ │ 도로관리팀│ 환경관리팀│ 시설관리팀│ 평균처리 │   │
│ │  92.1%  │  88.5%  │  95.3%  │ 2.3일  │   │
│ └─────────┴─────────┴─────────┴───────┘   │
└─────────────────────────────────────────┘
```

### 신고 처리 워크플로우
```mermaid
graph TD
    A[새 신고 접수] --> B[자동 카테고리 분류]
    B --> C[AI 추천 담당팀 표시]
    C --> D[관리자 확인]
    
    D --> E{신고 유효성}
    E -->|유효| F[담당팀 배정]
    E -->|무효| G[반려 처리]
    
    F --> H[담당자 배정]
    H --> I[현장 확인 요청]
    I --> J[처리 계획 수립]
    J --> K[작업 시작]
    K --> L[진행 상황 업데이트]
    L --> M[작업 완료]
    M --> N[완료 보고서 작성]
    N --> O[시민 알림 발송]
    
    G --> P[반려 사유 전송]
```

---

## 📱 모바일 UX 가이드라인

### 터치 인터페이스 디자인
```
버튼 크기 가이드라인:
┌─────────────────────────┐
│ 최소 터치 영역: 44x44pt  │
│ 권장 버튼 크기: 48x48pt  │
│ 주요 액션 버튼: 56x56pt  │
└─────────────────────────┘

간격 가이드라인:
┌─────────────────────────┐
│ 요소 간 최소 간격: 8pt   │
│ 섹션 간 간격: 16pt      │
│ 화면 여백: 20pt         │
└─────────────────────────┘
```

### 접근성 고려사항
```mermaid
graph TD
    A[접근성 기능] --> B[시각 접근성]
    A --> C[청각 접근성]
    A --> D[운동 접근성]
    
    B --> B1[큰 글씨 지원]
    B --> B2[고대비 모드]
    B --> B3[스크린 리더 지원]
    B --> B4[색상 외 구분 방법]
    
    C --> C1[진동 알림]
    C --> C2[시각적 알림]
    C --> C3[자막 지원]
    
    D --> D1[음성 입력 지원]
    D --> D2[큰 터치 영역]
    D --> D3[간단한 제스처]
```

---

## 🔄 데이터 동기화 플로우

### 오프라인/온라인 동기화
```mermaid
sequenceDiagram
    participant U as 사용자
    participant A as 앱 (로컬)
    participant S as 서버
    
    Note over A: 오프라인 상태
    U->>A: 신고 작성
    A->>A: 로컬 저장 (Draft)
    
    Note over A: 온라인 복원
    A->>S: 연결 상태 확인
    S->>A: 연결 성공
    A->>S: 대기중인 데이터 전송
    S->>A: 동기화 완료
    A->>A: 로컬 Draft 삭제
    A->>U: 동기화 완료 알림
```

---

## 🎯 사용자 여정 맵

### 신규 사용자 온보딩
```mermaid
journey
    title 신규 사용자 신고 제출 여정
    section 앱 설치
      앱 다운로드: 3: 사용자
      초기 설정: 4: 사용자
      권한 허용: 3: 사용자
    section 회원가입
      정보 입력: 4: 사용자
      인증 완료: 5: 사용자
      약관 동의: 3: 사용자
    section 첫 신고
      문제 발견: 2: 사용자
      앱 실행: 4: 사용자
      사진 촬영: 5: 사용자
      정보 입력: 4: 사용자
      AI 분석: 5: 사용자, 시스템
      제출 완료: 5: 사용자
    section 추적
      알림 수신: 5: 사용자
      진행 확인: 4: 사용자
      완료 확인: 5: 사용자
```

### 기존 사용자 일반적 사용
```mermaid
journey
    title 기존 사용자 정기 사용 여정
    section 일상 사용
      문제 발견: 2: 사용자
      즉시 신고: 5: 사용자
      빠른 제출: 5: 사용자
    section 관리
      진행 확인: 4: 사용자
      댓글 확인: 4: 사용자
      만족도 평가: 4: 사용자
```

---

이 시각적 가이드는 전라북도 신고 플랫폼의 모든 사용자 인터페이스와 상호작용을 명확하게 보여주며, 개발팀과 사용자 모두가 시스템을 이해하는 데 도움을 줍니다.